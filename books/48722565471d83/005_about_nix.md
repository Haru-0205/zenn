---
title: Nixについて
---

# Nixとは

Nixは、純粋関数型言語「Nix」を用いて宣言的に環境を設定できるパッケージマネージャーである。

## 特徴

### 再現性

Nixは、宣言的に環境を記述できるため、どうやっても基本的に同じ環境になる。  
また、バージョンを固定するときは、同時にハッシュ値をあわせて保存されるため、絶対に同じパッケージを導入できる。  

### 復元性

Nixは、基本的にいつでも前の状態に戻せるようになっている。  
そのため、システムに破壊的変更を加えるときの決断がしやすい。  
一方、定期的にGCを実行して履歴を削除しないとストレージがかなり圧迫される...

### 開発環境

#### Nix-Shell

NixにはNix-Shellという機能があり、これを使うことで必要なパッケージを**Globalに影響を与えずに**利用できる。  
その特性ゆえに、導入前のソフトの試用環境としても使われる。
ちなみにgitとneovimが入ったNix-Shellを立ち上げるコマンドは以下。

```nix
nix-shell -p git neovim
```

開発環境を定義したshell.nixファイルがある場合に開発環境を立ち上げるコマンドは以下。

```nix
nix-shell
```

#### Nix Flakes

一方、Nix-ShellにはLockファイルがなく、バージョン固定ができない。  
その欠点を改善したのが「Flakes」というExperimentalな機能である。

Flakesはグローバル設定でも便利であるが、開発環境でこそ真価を発揮する。  
ここでは、Input以外の内容はパッケージのビルドに影響を及ぼせないため、いわゆる「隠れ依存」を排除できる。

なお、Flakes.nixを書いておけば、開発環境は以下のコマンドで立ち上げられる。

```nix
nix develop
```
